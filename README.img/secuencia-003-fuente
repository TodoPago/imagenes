@startuml
skinparam roundcorner 20
skinparam sequenceArrowThickness 1

actor Browser #blue
"Browser" -> "E-commerce"
    note right: Comienzo del checkout
    activate Browser #gray
    activate "E-commerce" #gray

    "E-commerce" -> "SDK" : SendAuthorizeRequest(Array): Array
        activate "SDK" #gray

        "SDK" -> "SDK" : parseAuthorizeRequest(): Array
            note right: Parsea array al formato requerido\n para el Webservice
            activate "SDK" #DarkSalmon
            deactivate "SDK"

        "SDK" -> "Gateway" : AuthorizeRequest()
            activate Gateway #gray
        "Gateway" --> "SDK"
            deactivate Gateway

        "SDK" -> "SDK" : parseAuthorizeRequest\nResponse(AuthorizeRequestResponse):Array 
            activate "SDK" #DarkSalmon
            deactivate "SDK"
            note left: Parsea los datos recibidos\n por el Werservice para poder\n utilizar la url del gateway\n de pago y RequestKey
            
    "SDK" --> "E-commerce"
        note right: El E-commerce si la respuesta es OK,\n recibe y persiste un array\n con la url de pago, RequestKey\n y tambien devuelve el Token del mismo
        deactivate "SDK"
        
"E-commerce" --> "Browser" 
    note right: Redirecciona al formulario de pago
    deactivate "E-commerce"


"Browser" -> "Gateway" :
    activate Gateway #gray
    note right: Completa el formulario y\n realiza un llamado al gateway
"Gateway" --> "Browser"
    note right: El Gateway redirige al Browser con la\n url del checkout del E-commerce.
    deactivate Gateway


"Browser" -> "E-commerce"
    note right: El gateway al haber realizado la\n redireccion el flujo de datos se dirige\n hacia el controller del e-commerce custompage
    activate "E-commerce" #gray
    "E-commerce" -> "SDK" : getAuthorize(Array): Array
        activate SDK #gray
        
        "SDK" -> "SDK" : parseAuthorizeAnswer(Array)
            note right: Parsea datos al formato\n requerido por el Webservice   
            activate SDK #DarkSalmon
            deactivate SDK

        "SDK" -> "Gateway": AuthorizeAnswer()
            activate Gateway #gray
        "Gateway" --> "SDK"
            deactivate Gateway
            
        "SDK" -> "SDK" : parseAuthorizeAnswer\nResponse(Authorize AnswerResponse): Array
            note right: Parsea los datos para mostrar\n al E-commerce de manera prolija
            activate SDK #DarkSalmon
            deactivate SDK
        
    "SDK" --> "E-commerce"
        deactivate SDK
        note right: Recibe la respuesta de la\n confirmacion de transaccion
        
"E-commerce" --> "Browser"
    deactivate "E-commerce"
note right: Muestra pagina de confirmaci√≥n\n de pago dependiendo de los\n datos recibidos
deactivate "E-commerce" #gray

deactivate Browser
@enduml

--------------------------

ref:
editor: https://www.planttext.com/
documentacion: http://plantuml.com/
